<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Estudio Barber House</title>

    <!-- Font Awesome para los iconos -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/png" href="favicon.png">
</head>
<body>
    <header>
        <h1>Estudio Barber House</h1>
        <nav>
            <a href="#servicios">Servicios</a>
            <a href="#contacto">Contacto</a>
        </nav>
    </header>

    <section id="inicio" class="hero">
        <h2>Luce con presencia</h2>
        <p>Reserva tu cita y disfruta de la mejor barber√≠a de San Pedro de los Milagros.</p>
        <a href="#contacto" class="boton">Agenda tu cita</a>
    </section>

    <section id="servicios">
        <h2>Nuestros Servicios</h2>
        <div class="servicios-container">
            <div class="servicio">
                <i class="fa-solid fa-scissors"></i>
                <h3>Corte</h3>
                <p class="precio">$20.000</p>
                <p>El estilo que m√°s te guste, con acabado profesional.</p>
            </div>

            <div class="servicio">
                <i class="fa-solid fa-eye"></i>
                <h3>Cejas</h3>
                <p class="precio">$5.000</p>
                <p>Definici√≥n y limpieza de cejas con t√©cnica precisa.</p>
            </div>

            <div class="servicio">
                <i class="fa-solid fa-user"></i>
                <h3>Barba</h3>
                <p class="precio">$12.000</p>
                <p>Perfilado, afeitado y arreglo completo de barba.</p>
            </div>

            <div class="servicio">
                <i class="fa-solid fa-mask-face"></i>
                <h3>Mascarilla 5 pasos</h3>
                <p class="precio">$10.000</p>
                <p>Exfoliaci√≥n, hidrataci√≥n y mascarillas para limpiar y rejuvenecer la piel.</p>
            </div>
        </div>
    </section>

    <section id="contacto">
        <h2>Cont√°ctanos</h2>
        <p>ü™Æ Cr 51 CL 49+9 Atras de la iglesia</p>
        <p>üìß Instagram: XXX </p>
    </section>

<!-- === FORMULARIO CON HORAS DISPONIBLES === -->
<section id="agendar" class="formulario-cita">
  <h2>Agendar Cita</h2>
  <p>Selecciona el servicio, elige una hora disponible y deja tus datos üíà</p>

  <form id="formCita">
      <input type="text" id="nombre" placeholder="Tu nombre" required>
      <input type="tel" id="telefono" placeholder="Tu n√∫mero de tel√©fono" required>
      
      <select id="servicio" required>
          <option value="">Selecciona un servicio</option>
          <option value="Corte">Corte</option>
          <option value="Cejas">Cejas</option>
          <option value="Barba">Barba</option>
          <option value="Mascarilla 5 pasos">Mascarilla 5 pasos</option>
      </select>

      <input type="date" id="fecha" required>
      
      <select id="hora" required>
          <option value="">Selecciona una hora</option>
          <!-- Se llena autom√°ticamente desde Google Sheets -->
      </select>

      <button type="submit"><i class="fa-solid fa-calendar-check"></i> Reservar cita</button>
  </form>

  <p id="estado" style="margin-top:15px;"></p>
</section>

<script>
const SHEET_URL = "https://script.google.com/macros/s/AKfycbw8Q1KrjqBoOofNADhHd-jdkl5eoHrKGp11sSD4cJQ6TutG7ORjao8yHxkrLFaxH8mVxg/exec"; // ‚Üê rempl√°zalo por tu URL de Google Apps Script

async function cargarHoras() {
  const fecha = document.getElementById("fecha").value;
  const selectHora = document.getElementById("hora");
  selectHora.innerHTML = "<option value=''>Cargando horas...</option>";

  if (!fecha) return;

  const res = await fetch(`${SHEET_URL}?fecha=${fecha}`);
  const horasOcupadas = await res.json();

  const horas = [
    "11:00 AM", "12:00 AM", "1:00 pM", "2:00 PM",
    "3:00 PM", "4:00 PM", "5:00 PM", "6:00 PM", "7:00 PM"
  ];

  selectHora.innerHTML = "";
  horas.forEach(h => {
    const option = document.createElement("option");
    option.value = h;
    option.textContent = h;
    if (horasOcupadas.includes(h)) {
      option.disabled = true;
      option.textContent += " (Ocupado)";
    }
    selectHora.appendChild(option);
  });
}

document.getElementById("fecha").addEventListener("change", cargarHoras);

document.getElementById("formCita").addEventListener("submit", async e => {
  e.preventDefault();
  const data = {
    nombre: nombre.value,
    telefono: telefono.value,
    servicio: servicio.value,
    fecha: fecha.value,
    hora: hora.value
  };

  document.getElementById("estado").textContent = "Enviando...";
  const res = await fetch(SHEET_URL, {
    method: "POST",
    body: JSON.stringify(data)
  });

  const text = await res.text();
  document.getElementById("estado").textContent = text.includes("OK") ? 
    "‚úÖ Cita registrada con √©xito" : "‚ùå Error al registrar la cita";
});
</script>
